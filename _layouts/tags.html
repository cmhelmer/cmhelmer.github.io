---
# Tags layout
layout: default
---

{%- comment -%}

Build a tag archive for the site or a collection (site.tags does not include tags from collections), with links to documents.

Tags are treated as case-insensitive for the purpose of urls (all downcase), so use them accordingly. Tags are also run through the "slugify" filter. Watch out for similar tags which contain non-alphanumeric characters (hashtags are stripped, for example, so #tag = tag). If this is a problem, look at Jekyll's other (non-default) options for the "slugify" filter (https://jekyllrb.com/docs/templates/).

Link to individual tags by adding a hashtag and the tag name to the url. It works well when the permalink using this layout is set to an "index.html" page (with a trailing slash), like ".../tags/". Hashtags will then look like ".../tags/#tag".

{%- endcomment -%}

{%- assign collection = site.collections | where_exp: "collection", "collection.label == page.collection" | first -%}

<article id="{{ page.collection | default: 'site' }}-tags" class="{{ page.collection | default: 'site' }}-collection tags-doc main-doc" role="document"{%- if collection.color -%}{{" "}}style="--collection-color:{{ collection.color }}"{%- endif -%}>
	<header class="doc-header">
		<h1 class="doc-title doc-meta">{{ page.title }}</h1>
	</header>
	<div class="doc-content">

		{{ content }}

		{%- comment -%} Get list of unique tags for site or collection {%- endcomment -%}

		{%- if page.collection -%}
			{%- assign docs = site.documents | where: "collection", page.collection -%}
		{%- else -%}
			{%- assign docs = site.documents -%}
		{%- endif -%}
		{%- assign tags = docs | map: "tags" | uniq | sort_natural -%}

		{%- include list-tags.html my_tags=tags -%}

		{%- comment -%} Get tagged documents and display in sections {%- endcomment -%}

		{%- for tag in my_tags -%}
		<section id="{{ tag | slugify }}" class="tag-details">
			<h2 class="tag-summary"><a href="#{{ tag | slugify }}" class="tag">{{ tag }}</a></h2>
		
			{%- assign tagged_docs = docs | where_exp: "doc", "doc.tags contains tag" | sort: "uid", "first" | reverse -%}
			{%- include list-notes.html my_docs=tagged_docs -%}
		
		</section>
		{%- endfor -%}

	</div>
</article>
