{%- comment -%}

Some ideas taken from "jekyll-seo-tag" plugin by Ben Balter

{%- endcomment -%}

{%- if page.title -%}
{%- capture page_title -%}{%- include filter-title.html my_doc=page -%}{%- endcapture -%}
{%- endif -%}
{%- capture meta_title -%}
	{%- if page_title -%}
		{{- page_title -}}
		{{- " " -}}
		{{- site.title_separator | default: "|" -}}
		{{- " " -}}
	{%- endif -%}
	{{- site.title -}}
{%- endcapture -%}
<title>{{ meta_title | strip_html | strip }}</title>
<meta property="og:site_name" content="{{ site.title }}">
{%- if page_title -%}
<meta property="og:title" content="{{ page_title | strip | escape }}">
{%- endif -%}

{%- if page.content -%}
	{%- capture meta_description -%}
		{%- if page.excerpt -%}
			{{ page.excerpt }}
		{%- elsif page.content -%}
			{%- include filter-excerpt.html my_content=page.content -%}
		{%- else -%}
			{{ site.description }}
		{%- endif -%}
	{%- endcapture -%}
{%- endif -%}
{%- unless meta_description == empty -%}
<meta name="description" content="{{ meta_description | strip | escape }}">
<meta property="og:description" content="{{ meta_description | strip | escape }}">
{%- endunless -%}

{%- if page.tags -%}
<meta name="keywords" content="{{ page.tags | join: ',' }}">
{%- endif -%}

{%- if page.collection -%}
<meta name="collection" content="{{ page.collection }}">
{%- endif -%}

<meta name="author" content="{{ page.author.name | default: page.author | default: page.authors.first.name | default: page.authors.first | default: site.author.name | default: site.author }}">

{%- if page.date and page.date != site.time -%}
<meta property="og:type" content="article" />
<meta property="article:published_time" content="{{ page.date | date_to_xmlschema }}" />
{%- endif -%}

{%- if page.updated -%}
<meta name="revised" content="{{ page.updated | date_to_xmlschema }}">
{%- endif -%}

<meta property="og:locale" content="{{ page.lang | default: site.lang | default: 'en' | replace:'-','_' }}">

{%- if site.url -%}
<link rel="canonical" href="{{ page.url | site.url | absolute_url }}">
<meta property="og:url" content="{{ page.url | site.url | absolute_url }}">
{%- endif -%}

{%- if page.previous -%}
<link rel="prev" href="{{ page.previous.url | absolute_url }}" />
{%- endif -%}
{%- if page.next -%}
<link rel="next" href="{{ page.next.url | absolute_url }}" />
{%- endif -%}


{%- if site.facebook -%}
{%- if site.facebook.admins -%}
<meta property="fb:admins" content="{{ site.facebook.admins }}" />
{%- endif -%}

{%- if site.facebook.publisher -%}
<meta property="article:publisher" content="{{ site.facebook.publisher }}" />
{%- endif -%}

{%- if site.facebook.app_id -%}
<meta property="fb:app_id" content="{{ site.facebook.app_id }}" />
{%- endif -%}
{%- endif -%}

{%- if site.webmaster_verifications -%}
{%- if site.webmaster_verifications.google -%}
<meta name="google-site-verification" content="{{ site.webmaster_verifications.google }}" />
{%- endif -%}

{%- if site.webmaster_verifications.bing -%}
<meta name="msvalidate.01" content="{{ site.webmaster_verifications.bing }}" />
{%- endif -%}

{%- if site.webmaster_verifications.alexa -%}
<meta name="alexaVerifyID" content="{{ site.webmaster_verifications.alexa }}" />
{%- endif -%}

{%- if site.webmaster_verifications.yandex -%}
<meta name="yandex-verification" content="{{ site.webmaster_verifications.yandex }}" />
{%- endif -%}

{%- if site.webmaster_verifications.baidu -%}
<meta name="baidu-site-verification" content="{{ site.webmaster_verifications.baidu }}" />
{%- endif -%}
{%- endif -%}

{%- if site.microblog -%}
<link href="https://micro.blog/{{ site.microblog }}" rel="me">
{%- endif -%}

<link rel="author" href="humans.txt">
<meta name="designer" content="C. M. Helmer">


{%- comment -%}

{%- if seo_tag.image -%}
<meta property="og:image" content="{{ seo_tag.image.path }}" />
{%- if seo_tag.image.height -%}
<meta property="og:image:height" content="{{ seo_tag.image.height }}" />
{%- endif -%}
{%- if seo_tag.image.width -%}
<meta property="og:image:width" content="{{ seo_tag.image.width }}" />
{%- endif -%}
{%- endif -%}


{%- if site.twitter -%}
{%- if seo_tag.image -%}
<meta name="twitter:card" content="summary_large_image" />
{%- else -%}
<meta name="twitter:card" content="summary" />
{%- endif -%}

<meta name="twitter:site" content="@{{ site.twitter.username | replace:"@","" }}" />

{%- if seo_tag.author.twitter -%}
<meta name="twitter:creator" content="@{{ seo_tag.author.twitter }}" />
{%- endif -%}
{%- endif -%}


<script type="application/ld+json">
{{ seo_tag.json_ld | jsonify }}
</script>

{%- endcomment -%}
